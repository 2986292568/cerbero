# -*- Mode: Python -*- vi:si:et:sw=4:sts=4:ts=4:syntax=python


class Recipe(recipe.Recipe):
    name = 'gtk+'
    version = '2.24.10'
    license = 'LGPLv2'
    deps = ['glib', 'atk', 'pango', 'gdk-pixbuf', 'cairo']

    files_libs = ['libgailutil']
    files_bins = [
        'gtk-demo', 'gtk-update-icon-cache', 'gtk-query-immmodules-2.0',
        'gtk-builder-convert']
    files_etc = ['gtkrc']
    files_devel = [
        'lib/gtk-2.0',
        'lib/pkgconfig/gtk+-2.0.pc',
        'lib/pkgconfig/gdk-2.0.pc',
        'lib/pkgconfig/gail.pc',
        'include/gtk-2.0',
        'include/gail-1.0',
    ]
    platform_files_libs = {
        Platform.WINDOWS: ['libgtk-win32-2.0', 'libgdk-win32-2.0'],
        Platform.DARWIN: ['libgtk-x11-2.0', 'libgdk-x11-2.0'],
        Platform.LINUX: ['libgtk-x11-2.0', 'libgdk-x11-2.0'],
        }
    platform_files_devel = {
        Platform.WINDOWS: [
            'lib/pkgconfig/gtk+-win32-2.0.pc', 'lib/pkgconfig/gdk-win32-2.0.pc'],
        Platform.DARWIN: [
            'lib/pkgconfig/gtk+-x11-2.0.pc', 'lib/pkgconfig/gdk-x11-2.0.pc'],
        Platform.LINUX: [
            'lib/pkgconfig/gtk+-x11-2.0.pc', 'lib/pkgconfig/gdk-x11-2.0.pc'],
        }

    def prepare(self):
        if self.config.target_platform == Platform.WINDOWS:
            self.configure_options += '--disable-papi --disable-cups --with-included-immodules'

    def post_install(self):
        theme = "Clearlooks"
        if self.config.target_platform == Platform.WINDOWS:
            theme = "MS-Windows"
        gtkrc = 'gtk-theme-name = "%s"\n '\
                'gtk-fallback-icon-theme = "Tango"' % theme
        with open(os.path.join(self.config.prefix, 'etc', 'gtkrc'), 'w') as f:
            f.write(gtkrc)
