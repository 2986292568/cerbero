# -*- Mode: Python -*- vi:si:et:sw=4:sts=4:ts=4:syntax=python


class Recipe(recipe.Recipe):
    name = 'gst-xcconfig'
    version = '0.1'
    licenses = [License.LGPL]
    btype = BuildType.CUSTOM
    stype = SourceType.CUSTOM
    deps = ['gstreamer', 'gst-plugins-base', 'gtk+', 'clutter']

    files_devel = ['share/xcode/gstreamer-0.10.xcconfig',
                   'share/xcode/gstreamer-0.10-all.xcconfig',
                   'share/xcode/gstreamer-0.10-gtk+-2.0.xcconfig',
                   'share/xcode/gstreamer-0.10-clutter-1.0.xcconfig']

    def install(self):
        from cerbero.commands.genxcconfig import GenXCodeConfig
        from cerbero.ide.pkgconfig import PkgConfig

        outdir = os.path.join(self.config.prefix, 'share', 'xcode')
        pc_files = PkgConfig.list_all()
        gstreamer_all = [x for x in pc_files if x.startswith('gstreamer')]

        xcconfig = GenXCodeConfig()
        # Create a config file only with gstreamer-0.10
        xcconfig.runargs(self.config, outdir, 'gstreamer-0.10',
                           ['gstreamer-0.10'])

        # Create a config file only with all gstreamer's libraries
        xcconfig.runargs(self.config, outdir, 'gstreamer-0.10-all',
                           gstreamer_all)

        # Create a config file only with all gstreamer's libraries and GTK+
        xcconfig.runargs(self.config, outdir, 'gstreamer-0.10-gtk+-2.0',
                           gstreamer_all + ['gtk+-quartz-2.0'])

        # Create a config file only with all gstreamer's libraries and Clutter+
        xcconfig.runargs(self.config, outdir, 'gstreamer-0.10-clutter-1.0',
                           gstreamer_all + ['clutter-gst-1.0'])
